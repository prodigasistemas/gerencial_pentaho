<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>stage_paghist</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <directory>&#x2f;</directory>
    <parameters>
    </parameters>
    <log>
<trans-log-table><connection/>
<schema/>
<table/>
<size_limit_lines/>
<interval/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>TRANSNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>STATUS</id><enabled>Y</enabled><name>STATUS</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name><subject/></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name><subject/></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name><subject/></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name><subject/></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name><subject/></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name><subject/></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>STARTDATE</id><enabled>Y</enabled><name>STARTDATE</name></field><field><id>ENDDATE</id><enabled>Y</enabled><name>ENDDATE</name></field><field><id>LOGDATE</id><enabled>Y</enabled><name>LOGDATE</name></field><field><id>DEPDATE</id><enabled>Y</enabled><name>DEPDATE</name></field><field><id>REPLAYDATE</id><enabled>Y</enabled><name>REPLAYDATE</name></field><field><id>LOG_FIELD</id><enabled>Y</enabled><name>LOG_FIELD</name></field><field><id>EXECUTING_SERVER</id><enabled>N</enabled><name>EXECUTING_SERVER</name></field><field><id>EXECUTING_USER</id><enabled>N</enabled><name>EXECUTING_USER</name></field><field><id>CLIENT</id><enabled>N</enabled><name>CLIENT</name></field></trans-log-table>
<perf-log-table><connection/>
<schema/>
<table/>
<interval/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>SEQ_NR</id><enabled>Y</enabled><name>SEQ_NR</name></field><field><id>LOGDATE</id><enabled>Y</enabled><name>LOGDATE</name></field><field><id>TRANSNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>STEPNAME</id><enabled>Y</enabled><name>STEPNAME</name></field><field><id>STEP_COPY</id><enabled>Y</enabled><name>STEP_COPY</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>INPUT_BUFFER_ROWS</id><enabled>Y</enabled><name>INPUT_BUFFER_ROWS</name></field><field><id>OUTPUT_BUFFER_ROWS</id><enabled>Y</enabled><name>OUTPUT_BUFFER_ROWS</name></field></perf-log-table>
<channel-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>LOGGING_OBJECT_TYPE</id><enabled>Y</enabled><name>LOGGING_OBJECT_TYPE</name></field><field><id>OBJECT_NAME</id><enabled>Y</enabled><name>OBJECT_NAME</name></field><field><id>OBJECT_COPY</id><enabled>Y</enabled><name>OBJECT_COPY</name></field><field><id>REPOSITORY_DIRECTORY</id><enabled>Y</enabled><name>REPOSITORY_DIRECTORY</name></field><field><id>FILENAME</id><enabled>Y</enabled><name>FILENAME</name></field><field><id>OBJECT_ID</id><enabled>Y</enabled><name>OBJECT_ID</name></field><field><id>OBJECT_REVISION</id><enabled>Y</enabled><name>OBJECT_REVISION</name></field><field><id>PARENT_CHANNEL_ID</id><enabled>Y</enabled><name>PARENT_CHANNEL_ID</name></field><field><id>ROOT_CHANNEL_ID</id><enabled>Y</enabled><name>ROOT_CHANNEL_ID</name></field></channel-log-table>
<step-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>TRANSNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>STEPNAME</id><enabled>Y</enabled><name>STEPNAME</name></field><field><id>STEP_COPY</id><enabled>Y</enabled><name>STEP_COPY</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>LOG_FIELD</id><enabled>N</enabled><name>LOG_FIELD</name></field></step-log-table>
<metrics-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>METRICS_DATE</id><enabled>Y</enabled><name>METRICS_DATE</name></field><field><id>METRICS_CODE</id><enabled>Y</enabled><name>METRICS_CODE</name></field><field><id>METRICS_DESCRIPTION</id><enabled>Y</enabled><name>METRICS_DESCRIPTION</name></field><field><id>METRICS_SUBJECT</id><enabled>Y</enabled><name>METRICS_SUBJECT</name></field><field><id>METRICS_TYPE</id><enabled>Y</enabled><name>METRICS_TYPE</name></field><field><id>METRICS_VALUE</id><enabled>Y</enabled><name>METRICS_VALUE</name></field></metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
  <created_user>-</created_user>
  <created_date>2015&#x2f;11&#x2f;11 17&#x3a;46&#x3a;47.550</created_date>
  <modified_user>-</modified_user>
  <modified_date>2015&#x2f;11&#x2f;11 17&#x3a;46&#x3a;47.550</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA&#x3d;</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>Teste_comercial</name>
    <server>10.20.100.38</server>
    <type>POSTGRESQL</type>
    <access>Native</access>
    <database>comercial</database>
    <port>5432</port>
    <username>rafaela</username>
    <password>Encrypted 2be98afc86aa7f2e4b918a8718cc2fe8f</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>5432</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>Teste_pentaho</name>
    <server>10.20.100.38</server>
    <type>POSTGRESQL</type>
    <access>Native</access>
    <database>pentaho</database>
    <port>5432</port>
    <username>pentaho</username>
    <password>Encrypted 2be98afc86aa7f2e4cb09ab7eca93a7d5</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>5432</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <order>
  <hop> <from>stage_pagamento_paghist</from><to>Select values</to><enabled>Y</enabled> </hop>
  <hop> <from>Select values</from><to>stage_paghist</to><enabled>Y</enabled> </hop>
  </order>
  <step>
    <name>Select values</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <fields>      <field>        <name>pgmt_amreferenciaarrecadacao</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>imov_id</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>clie_id</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>pgmt_id</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>pgmt_dtpagamento</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>anomes_pagamento</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>avbc_id</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>pgst_idatual</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>dotp_id</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>arfm_id</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>cnta_id</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>gpag_id</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>dbac_id</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>last_id</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>lest_id</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>iper_id</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>loca_id</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>qdra_id</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>cnta_nnquadra</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>cnta_vlagua</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>cnta_vlesgoto</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>cnta_vlimpostos</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>cnta_vldebitos</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>cnta_vlcreditos</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>cnta_amreferenciaconta</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>cnta_dtvencimentoconta</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>anomes_vencimento</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>lapf_id</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>lepf_id</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>hidi_id</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>catg_id</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>scat_id</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>pgmt_vlpagamento</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>gpag_dtvencimento</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>gpag_amreferenciacontabil</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>fntp_id</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>lict_id</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>        <select_unspecified>N</select_unspecified>
      <meta>        <name>pgmt_amreferenciaarrecadacao</name>
        <rename>pgmt_amreferenciaarrecadacao</rename>
        <type>None</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>imov_id</name>
        <rename>imov_id</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>clie_id</name>
        <rename>clie_id</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>pgmt_id</name>
        <rename>pgmt_id</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>pgmt_dtpagamento</name>
        <rename>pgmt_dtpagamento</rename>
        <type>Timestamp</type>
        <length>6</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>anomes_pagamento</name>
        <rename>anomes_pagamento</rename>
        <type>Integer</type>
        <length>9</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>avbc_id</name>
        <rename>avbc_id</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>pgst_idatual</name>
        <rename>pgst_idatual</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>dotp_id</name>
        <rename>dotp_id</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>arfm_id</name>
        <rename>arfm_id</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>cnta_id</name>
        <rename>cnta_id</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>gpag_id</name>
        <rename>gpag_id</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>dbac_id</name>
        <rename>dbac_id</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>last_id</name>
        <rename>last_id</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>lest_id</name>
        <rename>lest_id</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>iper_id</name>
        <rename>iper_id</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>loca_id</name>
        <rename>loca_id</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>qdra_id</name>
        <rename>qdra_id</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>cnta_nnquadra</name>
        <rename>cnta_nnquadra</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>cnta_vlagua</name>
        <rename>cnta_vlagua</rename>
        <type>Number</type>
        <length>15</length>
        <precision>2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>cnta_vlesgoto</name>
        <rename>cnta_vlesgoto</rename>
        <type>Number</type>
        <length>15</length>
        <precision>2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>cnta_vlimpostos</name>
        <rename>cnta_vlimpostos</rename>
        <type>Number</type>
        <length>15</length>
        <precision>2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>cnta_vldebitos</name>
        <rename>cnta_vldebitos</rename>
        <type>Number</type>
        <length>15</length>
        <precision>2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>cnta_vlcreditos</name>
        <rename>cnta_vlcreditos</rename>
        <type>Number</type>
        <length>15</length>
        <precision>2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>cnta_amreferenciaconta</name>
        <rename>cnta_amreferenciaconta</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>cnta_dtvencimentoconta</name>
        <rename>cnta_dtvencimentoconta</rename>
        <type>Timestamp</type>
        <length>6</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>anomes_vencimento</name>
        <rename>anomes_vencimento</rename>
        <type>Integer</type>
        <length>9</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>lapf_id</name>
        <rename>lapf_id</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>lepf_id</name>
        <rename>lepf_id</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>hidi_id</name>
        <rename>hidi_id</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>catg_id</name>
        <rename>catg_id</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>scat_id</name>
        <rename>scat_id</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>pgmt_vlpagamento</name>
        <rename>pgmt_vlpagamento</rename>
        <type>Number</type>
        <length>15</length>
        <precision>2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>gpag_dtvencimento</name>
        <rename>gpag_dtvencimento</rename>
        <type>Timestamp</type>
        <length>6</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>gpag_amreferenciacontabil</name>
        <rename>gpag_amreferenciacontabil</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>fntp_id</name>
        <rename>fntp_id</rename>
        <type>Integer</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>      <meta>        <name>lict_id</name>
        <rename>lict_id</rename>
        <type>None</type>
        <length>9</length>
        <precision>0</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>    </fields>     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>352</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>stage_pagamento_paghist</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>Teste_comercial</connection>
    <sql>-------Garar stage_paghist--&#xd;&#xa;-------COSANPA--------------&#xd;&#xa;-------Vers&#xe3;o 10&#x2f;03&#x2f;16------&#xd;&#xa;select &#xa;pgmt_amreferenciaarrecadacao,&#xa;pg.imov_id,&#xa;pg.clie_id,&#xa;pgmt_id,&#xa;pgmt_dtpagamento,&#xa;cast&#x28;&#x28;substr&#x28;cast&#x28;pgmt_dtpagamento as char&#x28;4&#x29;&#x29;,1,4&#x29;&#x7c;&#x7c;substr&#x28;cast&#x28;pgmt_dtpagamento as char&#x28;7&#x29;&#x29;,6,2&#x29;&#x29; as integer &#x29; as anomes_pagamento,&#xa;pg.avbc_id,&#xa;pg.pgst_idatual,&#xa;pg.dotp_id,&#xa;pg.arfm_id,&#xa;pg.cnta_id,&#xa;pg.gpag_id,&#xa;pg.dbac_id,&#xa;coalesce&#x28;ct.last_id,0&#x29;      as last_id,&#xa;coalesce&#x28;ct.lest_id,0&#x29;      as lest_id, &#xa;coalesce&#x28;ct.iper_id,0&#x29;      as iper_id,&#xa;coalesce&#x28;ct.loca_id,0&#x29;      as loca_id,&#xa;coalesce&#x28;ct.qdra_id,0&#x29;      as qdra_id,&#xa;coalesce&#x28;ct.cnta_nnquadra&#x29;  as cnta_nnquadra,&#xa;coalesce&#x28;cnta_vlagua,0&#x29;     as cnta_vlagua,&#xa;coalesce&#x28;cnta_vlesgoto,0&#x29;   as cnta_vlesgoto,&#xa;coalesce&#x28;cnta_vlimpostos,0&#x29; as cnta_vlimpostos,&#xa;coalesce&#x28;cnta_vldebitos,0&#x29;  as cnta_vldebitos,&#xa;coalesce&#x28;cnta_vlcreditos,0&#x29; as cnta_vlcreditos,&#xa;cnta_amreferenciaconta,&#xa;cnta_dtvencimentoconta,&#xa;cast&#x28;&#x28;substr&#x28;cast&#x28;cnta_dtvencimentoconta as char&#x28;4&#x29;&#x29;,1,4&#x29;&#x7c;&#x7c;substr&#x28;cast&#x28;cnta_dtvencimentoconta as char&#x28;7&#x29;&#x29;,6,2&#x29;&#x29; as integer &#x29; as anomes_vencimento,&#xa;coalesce&#x28;lapf_id,0&#x29; as lapf_id,&#xa;coalesce&#x28;lepf_id,0&#x29; as lepf_id,&#xa;la.hidi_id,&#xa;&#x28;select catg_id from cadastro.imovel_subcategoria cat join cadastro.subcategoria sub on cat.scat_id &#x3d; sub.scat_id where cat.imov_id &#x3d; pg.imov_id order by imsb_qteconomia desc limit 1&#x29; as catg_id, &#xa;&#x28;select scat_id from cadastro.imovel_subcategoria cat where cat.imov_id &#x3d; pg.imov_id order by imsb_qteconomia desc limit 1&#x29; as scat_id,&#xa;coalesce&#x28;pgmt_vlpagamento,0&#x29; as pgmt_vlpagamento,&#xa;gpag_dtvencimento                 as gpag_dtvencimento, &#xa;gpag_amreferenciacontabil         as gpag_amreferenciacontabil,&#xa;gppr.fntp_id,&#xa;gppr.lict_id&#xa;from arrecadacao.pagamento pg&#xa;INNER JOIN cadastro.sistema_parametros           on 1 &#x3d; 1 &#xa;LEFT  JOIN cadastro.imovel im                    on im.imov_id  &#x3d; pg.imov_id &#xa;LEFT  JOIN faturamento.conta ct                  on ct.cnta_id  &#x3d; pg.cnta_id&#xa;LEFT  JOIN atendimentopublico.ligacao_agua la    on la.lagu_id  &#x3d; ct.imov_id&#xa;LEFT  JOIN atendimentopublico.ligacao_esgoto le  on le.lesg_id  &#x3d; ct.imov_id&#xa;LEFT  JOIN faturamento.guia_pagamento gppr       on gppr.gpag_id &#x3d; pg.gpag_id&#xa;where pgmt_amreferenciaarrecadacao &#x3d; parm_amreferenciaarrecadacao  &#xa;---------&#xa;UNION ALL   --- UNIR OS PAGAMENTOS DAS TABELAS PAGAMENTO E PAGAMENTO_HISTORICO&#xa;---------&#xa;select &#xa;pghi_amreferenciaarrecadacao,&#xa;ph.imov_id,&#xa;ph.clie_id,&#xa;pghi_id,&#xa;pghi_dtpagamento,&#xa;cast&#x28;&#x28;substr&#x28;cast&#x28;pghi_dtpagamento as char&#x28;4&#x29;&#x29;,1,4&#x29;&#x7c;&#x7c;substr&#x28;cast&#x28;pghi_dtpagamento as char&#x28;7&#x29;&#x29;,6,2&#x29;&#x29; as integer &#x29; as anomes_pagamento,&#xa;ph.avbc_id,&#xa;ph.pgst_idatual,&#xa;ph.dotp_id,&#xa;ph.arfm_id,&#xa;ph.cnta_id,&#xa;ph.gpag_id,&#xa;ph.dbac_id,&#xa;coalesce&#x28;ch.last_id,0&#x29;      as last_id,&#xa;coalesce&#x28;ch.lest_id,0&#x29;      as lest_id, &#xa;coalesce&#x28;ch.iper_id,0&#x29;      as iper_id,&#xa;coalesce&#x28;ch.loca_id,0&#x29;      as loca_id,&#xa;coalesce&#x28;ch.qdra_id,0&#x29;      as qdra_id,&#xa;coalesce&#x28;ch.cnhi_nnquadra&#x29;  as cnhi_nnquadra,&#xa;coalesce&#x28;cnhi_vlagua,0&#x29;     as cnhi_vlagua,&#xa;coalesce&#x28;cnhi_vlesgoto,0&#x29;   as cnhi_vlesgoto,&#xa;coalesce&#x28;cnhi_vlimpostos,0&#x29; as cnhi_vlimpostos,&#xa;coalesce&#x28;cnhi_vldebitos,0&#x29;  as cnta_vldebitos,&#xa;coalesce&#x28;cnhi_vlcreditos,0&#x29; as cnta_vlcreditos,&#xa;cnhi_amreferenciaconta,&#xa;cnhi_dtvencimentoconta,&#xa;cast&#x28;&#x28;substr&#x28;cast&#x28;cnhi_dtvencimentoconta as char&#x28;4&#x29;&#x29;,1,4&#x29;&#x7c;&#x7c;substr&#x28;cast&#x28;cnhi_dtvencimentoconta as char&#x28;7&#x29;&#x29;,6,2&#x29;&#x29; as integer &#x29; as anomes_vencimento,&#xa;coalesce&#x28;lapf_id,0&#x29; as lapg_id,&#xa;coalesce&#x28;lepf_id,0&#x29; as lepf_id,&#xa;la.hidi_id,&#xa;&#x28;select catg_id from cadastro.imovel_subcategoria cat join cadastro.subcategoria sub on cat.scat_id &#x3d; sub.scat_id where cat.imov_id &#x3d; ph.imov_id order by imsb_qteconomia desc limit 1&#x29; as catg_id, &#xa;&#x28;select scat_id from cadastro.imovel_subcategoria cat where cat.imov_id &#x3d; ph.imov_id order by imsb_qteconomia desc limit 1&#x29; as scat_id,&#xa;coalesce&#x28;pghi_vlpagamento,0&#x29; as pgmt_vlpagamento,&#xa;gphi_dtvencimento                 as gpag_dtvencimento, &#xa;gphi_amreferenciacontabil         as gpag_amreferenciacontabil,&#xa;gpph.fntp_id,&#xa;gpph.lict_id&#xa;from arrecadacao.pagamento_historico ph&#xa;INNER JOIN cadastro.sistema_parametros                    on 1 &#x3d; 1 &#xa;LEFT  JOIN cadastro.imovel im                             on im.imov_id  &#x3d; ph.imov_id &#xa;LEFT  JOIN faturamento.conta_historico ch                 on ch.cnta_id  &#x3d; ph.cnta_id&#xa;LEFT  JOIN atendimentopublico.ligacao_agua la             on la.lagu_id  &#x3d; ch.imov_id&#xa;LEFT  JOIN atendimentopublico.ligacao_esgoto le           on le.lesg_id  &#x3d; ch.imov_id&#xa;LEFT  JOIN faturamento.guia_pagamento_historico gpph      on gpph.gpag_id &#x3d; ph.gpag_id &#xa;where pghi_amreferenciaarrecadacao &#x3d; parm_amreferenciaarrecadacao   &#xa;-----------------------FIM DO SQL---------------------------------  </sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>112</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>stage_paghist</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>Teste_pentaho</connection>
    <schema>dw</schema>
    <table>stage_paghist</table>
    <commit>1000</commit>
    <truncate>Y</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>N</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>544</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step_error_handling>
  </step_error_handling>
   <slave-step-copy-partition-distribution>
</slave-step-copy-partition-distribution>
   <slave_transformation>N</slave_transformation>

</transformation>
